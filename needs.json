{"created": "2025-10-20T17:24:45.217309", "current_version": "", "project": "ESP32 Template", "versions": {"": {"created": "2025-10-20T17:24:45.217298", "creator": {"program": "sphinx_needs", "version": "6.0.1"}, "needs": {"REQ_CFG_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL consolidate all user-configurable parameters into a centralized configuration module, using appropriate data types for embedded performance optimization.\n\n**Rationale:** Centralized configuration simplifies maintenance, reduces code duplication, and enables runtime configuration changes.\n\n**Acceptance Criteria:**\n\n- AC-1: All configurable parameters SHALL be defined in configuration module\n- AC-2: Configuration SHALL use appropriate data types (integers, enums, etc.)\n- AC-3: Hardware-specific constants SHALL remain in component headers\n- AC-4: Configuration SHALL be accessible from all application modules", "created_at": "", "docname": "11_requirements/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_CFG_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 15, "links": ["REQ_SYS_CFG_1"], "links_back": ["REQ_CFG_2", "REQ_CFG_3", "REQ_CFG_9", "SPEC_CFG_ARCH_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Static Configuration Management", "sections": ["Static Configuration Management", "Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "architecture"], "template": null, "title": "Centralized Configuration Header", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_10": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL gracefully handle NVS read/write failures and continue operating with default configuration.\n\n**Rationale:** NVS corruption or flash wear-out should not prevent system boot.\n\n**Acceptance Criteria:**\n\n- AC-1: NVS read failure SHALL log error and use default configuration\n- AC-2: NVS write failure SHALL log error and continue operation\n- AC-3: System SHALL boot successfully even if NVS is corrupted\n- AC-4: Web interface SHALL indicate NVS errors to user", "created_at": "", "docname": "11_requirements/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_CFG_10", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 197, "links": ["REQ_CFG_4"], "links_back": ["SPEC_CFG_ERROR_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Configuration Error Handling", "sections": ["Configuration Error Handling", "Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "error-handling"], "template": null, "title": "NVS Error Recovery", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_11": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The configuration manager SHOULD log all configuration changes for debugging and audit purposes.\n\n**Rationale:** Configuration change history aids debugging and security auditing.\n\n**Acceptance Criteria:**\n\n- AC-1: Log SHALL include timestamp, parameter name, old value, new value\n- AC-2: Log SHALL use appropriate log level (INFO for changes, ERROR for failures)\n- AC-3: Log SHALL be readable via serial console\n- AC-4: Log format SHALL be parseable for automated analysis", "created_at": "", "docname": "11_requirements/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_CFG_11", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 216, "links": ["REQ_CFG_5", "REQ_CFG_8"], "links_back": ["SPEC_CFG_LOGGING_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "section_name": "Configuration Error Handling", "sections": ["Configuration Error Handling", "Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "logging", "debugging"], "template": null, "title": "Configuration Logging", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_2": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** All application components SHALL access configuration parameters through the centralized configuration module rather than defining local constants.\n\n**Rationale:** Ensures single source of truth for configuration values and enables runtime reconfiguration.\n\n**Acceptance Criteria:**\n\n- AC-1: Components SHALL include configuration module header\n- AC-2: Components SHALL NOT define duplicate configuration constants\n- AC-3: Configuration access SHALL be type-safe\n- AC-4: Invalid configuration access SHALL be detected at compile time", "created_at": "", "docname": "11_requirements/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_CFG_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 34, "links": ["REQ_CFG_1"], "links_back": ["SPEC_CFG_ARCH_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Static Configuration Management", "sections": ["Static Configuration Management", "Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "api"], "template": null, "title": "Compile-Time Configuration Access", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_3": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL maintain a runtime-modifiable configuration structure that mirrors compile-time default values.\n\n**Rationale:** Enables users to modify configuration at runtime without firmware recompilation.\n\n**Acceptance Criteria:**\n\n- AC-1: Runtime configuration structure SHALL contain all user-configurable parameters\n- AC-2: Runtime configuration SHALL be initialized with compile-time defaults on boot\n- AC-3: Runtime configuration SHALL use same data types as compile-time constants\n- AC-4: Configuration structure SHALL be memory-efficient for embedded constraints", "created_at": "", "docname": "11_requirements/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_CFG_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 56, "links": ["REQ_CFG_1", "REQ_SYS_CFG_1"], "links_back": ["REQ_CFG_4", "REQ_CFG_6", "REQ_WEB_2", "SPEC_CFG_FLOW_1", "SPEC_CFG_STORAGE_1", "SPEC_CFG_RUNTIME_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Runtime Configuration Management", "sections": ["Runtime Configuration Management", "Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "runtime"], "template": null, "title": "Runtime Configuration Structure", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_4": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL store runtime configuration in non-volatile storage (NVS) to persist across reboots.\n\n**Rationale:** Users expect configuration changes to survive power cycles.\n\n**Acceptance Criteria:**\n\n- AC-1: Configuration SHALL be saved to NVS when modified\n- AC-2: Configuration SHALL be loaded from NVS on boot\n- AC-3: NVS write failures SHALL be logged and reported\n- AC-4: Configuration SHALL use ESP-IDF NVS API for storage", "created_at": "", "docname": "11_requirements/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_CFG_4", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 75, "links": ["REQ_CFG_3", "REQ_SYS_CFG_1"], "links_back": ["REQ_CFG_5", "REQ_CFG_8", "REQ_CFG_10", "SPEC_CFG_FLOW_1", "SPEC_CFG_STORAGE_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Runtime Configuration Management", "sections": ["Runtime Configuration Management", "Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "storage", "nvs"], "template": null, "title": "Persistent Configuration Storage", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_5": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The configuration manager SHALL provide thread-safe API functions to read configuration parameters.\n\n**Rationale:** Multiple tasks may need concurrent access to configuration values.\n\n**Acceptance Criteria:**\n\n- AC-1: Read API SHALL return current runtime configuration values\n- AC-2: Read API SHALL be thread-safe (use mutexes if needed)\n- AC-3: Read API SHALL have minimal performance overhead\n- AC-4: Read API SHALL provide type-safe parameter access", "created_at": "", "docname": "11_requirements/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_CFG_5", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 97, "links": ["REQ_CFG_4"], "links_back": ["REQ_CFG_7", "REQ_CFG_11", "SPEC_CFG_FLOW_1", "SPEC_CFG_PARAM_1", "SPEC_CFG_API_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Configuration API", "sections": ["Configuration API", "Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "api"], "template": null, "title": "Configuration Read API", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_6": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL validate configuration parameter values to ensure they are within acceptable ranges before accepting changes.\n\n**Rationale:** Invalid configuration can cause system malfunction or safety hazards.\n\n**Acceptance Criteria:**\n\n- AC-1: Each parameter SHALL have defined minimum and maximum values\n- AC-2: Write API SHALL reject out-of-range values with error code\n- AC-3: Validation SHALL prevent invalid parameter combinations\n- AC-4: Validation errors SHALL be logged with specific parameter name", "created_at": "", "docname": "11_requirements/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_CFG_6", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 116, "links": ["REQ_CFG_3"], "links_back": ["SPEC_CFG_API_1", "SPEC_CFG_VALIDATION_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Configuration API", "sections": ["Configuration API", "Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "validation"], "template": null, "title": "Configuration Validation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_7": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The configuration manager SHALL provide HTTP handlers for web-based configuration access and modification.\n\n**Rationale:** Users need remote configuration capability via web interface.\n\n**Acceptance Criteria:**\n\n- AC-1: HTTP GET handler SHALL return current configuration as JSON\n- AC-2: JSON format SHALL be human-readable and self-documenting\n- AC-3: Configuration SHALL include parameter metadata (units, ranges)\n- AC-4: HTTP handler SHALL be integrated with web server component", "created_at": "", "docname": "11_requirements/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_CFG_7", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 135, "links": ["REQ_CFG_5", "REQ_WEB_2"], "links_back": ["REQ_CFG_8", "REQ_CFG_9", "SPEC_CFG_WEB_API_1", "SPEC_CFG_UI_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Configuration API", "sections": ["Configuration API", "Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "web", "api"], "template": null, "title": "Configuration Web Interface", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_8": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The web interface SHALL provide capability to save configuration changes to NVS storage.\n\n**Rationale:** Users need to persist configuration changes across reboots.\n\n**Acceptance Criteria:**\n\n- AC-1: HTTP POST handler SHALL accept configuration updates as JSON\n- AC-2: Handler SHALL validate parameters before applying changes\n- AC-3: Handler SHALL save valid configuration to NVS\n- AC-4: Handler SHALL return success/error status with descriptive message\n- AC-5: Handler SHALL apply configuration immediately (no reboot required)", "created_at": "", "docname": "11_requirements/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_CFG_8", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 154, "links": ["REQ_CFG_7", "REQ_CFG_4"], "links_back": ["REQ_CFG_11", "SPEC_CFG_WEB_API_1", "SPEC_CFG_PREVIEW_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Configuration API", "sections": ["Configuration API", "Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "web", "persistence"], "template": null, "title": "Configuration Save Operation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_CFG_9": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The web interface SHALL provide functionality to reload configuration from NVS or restore factory defaults.\n\n**Rationale:** Users may need to undo configuration changes or recover from misconfiguration.\n\n**Acceptance Criteria:**\n\n- AC-1: Reload operation SHALL re-read configuration from NVS\n- AC-2: Factory reset SHALL restore compile-time default values\n- AC-3: Factory reset SHALL clear NVS configuration storage\n- AC-4: Both operations SHALL be accessible via HTTP POST requests\n- AC-5: Operations SHALL return confirmation messages", "created_at": "", "docname": "11_requirements/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_CFG_9", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 174, "links": ["REQ_CFG_7", "REQ_CFG_1"], "links_back": ["SPEC_CFG_WEB_API_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Configuration API", "sections": ["Configuration API", "Configuration Manager Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["config", "web", "factory-reset"], "template": null, "title": "Configuration Reset/Reload", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide a custom network interface driver that bridges ESP32's UART to the host network stack when running in QEMU emulation.\n\n**Rationale:** QEMU does not natively support ESP32 WiFi emulation. A UART tunnel enables network connectivity for testing web server and WiFi-dependent features.\n\n**Acceptance Criteria:**\n\n- AC-1: Driver SHALL register as lwIP network interface\n- AC-2: Driver SHALL use UART1 for packet transport to/from QEMU\n- AC-3: Driver SHALL be conditionally compiled only for QEMU target\n- AC-4: Driver SHALL not interfere with real hardware WiFi driver", "created_at": "", "docname": "11_requirements/netif-tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_NETIF_TUNNEL_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 15, "links": ["REQ_SYS_SIM_1"], "links_back": ["REQ_NETIF_TUNNEL_2", "REQ_NETIF_TUNNEL_3", "REQ_NETIF_TUNNEL_4", "REQ_NETIF_TUNNEL_5", "REQ_NETIF_TUNNEL_NF_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "network", "qemu", "uart"], "template": null, "title": "QEMU UART Network Bridge", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_2": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The tunnel driver SHALL encapsulate Ethernet frames for transmission over UART with appropriate framing and error detection.\n\n**Rationale:** UART is a byte-stream transport; Ethernet frame boundaries must be preserved.\n\n**Acceptance Criteria:**\n\n- AC-1: Driver SHALL frame packets with length prefix or delimiter\n- AC-2: Driver SHALL detect and discard corrupted packets\n- AC-3: Framing SHALL support MTU-sized packets (1500 bytes)\n- AC-4: Framing overhead SHALL be minimal (<10 bytes per packet)", "created_at": "", "docname": "11_requirements/netif-tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_NETIF_TUNNEL_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 34, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": ["REQ_NETIF_TUNNEL_NF_2"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "protocol"], "template": null, "title": "Packet Encapsulation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_3": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The project SHALL provide a Python script that bridges QEMU's UART to the host's TAP network interface.\n\n**Rationale:** QEMU UART output must be forwarded to host network stack for external connectivity.\n\n**Acceptance Criteria:**\n\n- AC-1: Script SHALL create TAP interface on host OS\n- AC-2: Script SHALL forward packets bidirectionally between UART and TAP\n- AC-3: Script SHALL handle QEMU's character device socket protocol\n- AC-4: Script SHALL be executable on Linux and macOS\n- AC-5: Script SHALL provide logging for debugging", "created_at": "", "docname": "11_requirements/netif-tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_NETIF_TUNNEL_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 53, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": ["REQ_NETIF_TUNNEL_DOC_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "tooling", "host"], "template": null, "title": "Host-Side Bridge Script", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_4": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The tunnel network interface SHALL support DHCP client operation to obtain IP address from host network.\n\n**Rationale:** Automatic IP configuration simplifies emulation setup and mirrors real WiFi behavior.\n\n**Acceptance Criteria:**\n\n- AC-1: Driver SHALL support lwIP DHCP client\n- AC-2: DHCP discovery packets SHALL be forwarded via UART tunnel\n- AC-3: Driver SHALL obtain valid IP address from host DHCP server\n- AC-4: IP configuration SHALL be logged to console", "created_at": "", "docname": "11_requirements/netif-tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_NETIF_TUNNEL_4", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 73, "links": ["REQ_NETIF_TUNNEL_1", "REQ_SYS_NET_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "network", "dhcp"], "template": null, "title": "DHCP Client Support", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_5": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The tunnel driver SHALL be conditionally compiled only when building for QEMU target, with zero overhead on real hardware builds.\n\n**Rationale:** Real hardware uses WiFi driver; tunnel driver is emulation-specific.\n\n**Acceptance Criteria:**\n\n- AC-1: Driver SHALL be wrapped in `#ifdef CONFIG_IDF_TARGET_ESP32_QEMU`\n- AC-2: Driver SHALL NOT be linked in hardware builds\n- AC-3: Application code SHALL detect emulation mode at runtime\n- AC-4: Build system SHALL provide clear documentation for enabling QEMU mode", "created_at": "", "docname": "11_requirements/netif-tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_NETIF_TUNNEL_5", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 92, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "build"], "template": null, "title": "Conditional Compilation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_DOC_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The project SHALL provide clear documentation for setting up and using QEMU emulation with network tunnel.\n\n**Rationale:** Developers need step-by-step instructions to use emulation features.\n\n**Acceptance Criteria:**\n\n- AC-1: Documentation SHALL include QEMU build/installation instructions\n- AC-2: Documentation SHALL explain TAP interface setup on Linux/macOS\n- AC-3: Documentation SHALL provide example commands for running emulation\n- AC-4: Documentation SHALL describe limitations compared to real hardware", "created_at": "", "docname": "11_requirements/netif-tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_NETIF_TUNNEL_DOC_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 153, "links": ["REQ_NETIF_TUNNEL_3", "REQ_SYS_SIM_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Documentation Requirements", "sections": ["Documentation Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "documentation"], "template": null, "title": "Emulation Setup Documentation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_NF_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The UART tunnel SHOULD support sufficient throughput for web interface testing (minimum 100 KB/s).\n\n**Rationale:** Web page loads and AJAX updates require reasonable bandwidth.\n\n**Acceptance Criteria:**\n\n- AC-1: Tunnel SHALL sustain at least 100 KB/s bidirectional throughput\n- AC-2: Web page loads SHALL complete within 5 seconds over tunnel\n- AC-3: UART baud rate SHALL be configurable (default 921600)", "created_at": "", "docname": "11_requirements/netif-tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_NETIF_TUNNEL_NF_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 114, "links": ["REQ_NETIF_TUNNEL_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "section_name": "Performance Requirements", "sections": ["Performance Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "performance"], "template": null, "title": "Tunnel Throughput", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_NETIF_TUNNEL_NF_2": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The tunnel driver SHOULD handle UART packet loss gracefully without crashing.\n\n**Rationale:** QEMU's UART emulation may occasionally drop bytes under high load.\n\n**Acceptance Criteria:**\n\n- AC-1: Driver SHALL detect framing errors and discard partial packets\n- AC-2: TCP connections SHALL recover from occasional packet loss\n- AC-3: Driver SHALL log packet loss statistics for debugging", "created_at": "", "docname": "11_requirements/netif-tunnel", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_NETIF_TUNNEL_NF_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 132, "links": ["REQ_NETIF_TUNNEL_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "section_name": "Performance Requirements", "sections": ["Performance Requirements", "Network Interface Tunnel Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulation", "reliability"], "template": null, "title": "Packet Loss Handling", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_ARCH_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL implement modular component-based architecture following ESP-IDF conventions.\n\n**Rationale:**\nEnables maintainability, testability, and reusability.\n\n**Acceptance Criteria:**\n\n* AC-1: Components provide well-defined APIs\n* AC-2: Components are independently testable\n* AC-3: Main application coordinates components without tight coupling", "created_at": "", "docname": "11_requirements/system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_SYS_ARCH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 79, "links": [], "links_back": ["SPEC_ARCH_LAYERS_1", "SPEC_ARCH_COMM_1", "SPEC_ARCH_TASKS_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["architecture", "modularity"], "template": null, "title": "Component-based Architecture", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_CFG_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL persist configuration settings across power cycles using ESP32 NVS (Non-Volatile Storage).\n\n**Rationale:**\nMaintains user settings and system configuration permanently.\n\n**Acceptance Criteria:**\n\n* AC-1: Configuration survives device reset and power loss\n* AC-2: Factory reset capability restores default settings\n* AC-3: Configuration corruption detection and recovery", "created_at": "", "docname": "11_requirements/system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_SYS_CFG_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 61, "links": [], "links_back": ["REQ_CFG_1", "REQ_CFG_3", "REQ_CFG_4", "SPEC_ARCH_CONFIG_1", "SPEC_ARCH_CONFIG_FLOW_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["storage", "nvs", "configuration"], "template": null, "title": "Non-volatile Configuration Storage", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_HW_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL operate on ESP32 microcontroller with 4MB flash memory.\n\n**Rationale:**\nESP32 provides WiFi connectivity, sufficient processing power, and adequate flash memory for IoT applications.\n\n**Acceptance Criteria:**\n\n* AC-1: System boots successfully on ESP32 WROOM-32 or compatible modules\n* AC-2: Flash usage does not exceed 90% of available 4MB\n* AC-3: System operates within ESP32 memory constraints (DRAM/IRAM)", "created_at": "", "docname": "11_requirements/system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_SYS_HW_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 6, "links": [], "links_back": ["SPEC_ARCH_MEMORY_1", "SPEC_ARCH_BUILD_1", "SPEC_ARCH_FLASH_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["hardware", "platform"], "template": null, "title": "ESP32 Hardware Platform", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_NET_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL provide WiFi connectivity in both Access Point (AP) and Station (STA) modes.\n\n**Rationale:**\nEnables web interface access and network configuration flexibility.\n\n**Acceptance Criteria:**\n\n* AC-1: System creates WiFi Access Point for initial configuration\n* AC-2: System connects to existing WiFi networks as station\n* AC-3: Automatic fallback to AP mode if STA connection fails", "created_at": "", "docname": "11_requirements/system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_SYS_NET_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 24, "links": [], "links_back": ["REQ_NETIF_TUNNEL_4", "REQ_SYS_WEB_1", "REQ_WEB_3"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["network", "wifi"], "template": null, "title": "WiFi Connectivity", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_PERF_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL manage memory efficiently within ESP32 constraints.\n\n**Rationale:**\nPrevents memory leaks and ensures stable operation.\n\n**Acceptance Criteria:**\n\n* AC-1: Heap usage monitored and bounded\n* AC-2: No memory leaks during normal operation\n* AC-3: Stack overflow protection for all tasks\n* AC-4: Dynamic allocation minimized in time-critical paths", "created_at": "", "docname": "11_requirements/system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_SYS_PERF_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 116, "links": [], "links_back": ["SPEC_ARCH_PERF_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["performance", "memory"], "template": null, "title": "Memory Management", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_REL_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL handle errors gracefully and attempt recovery where possible.\n\n**Rationale:**\nEnsures system reliability and user experience.\n\n**Acceptance Criteria:**\n\n* AC-1: Component timeouts handled without system crash\n* AC-2: Network connection failures trigger automatic retry\n* AC-3: System logs errors for diagnostics\n* AC-4: Watchdog timer prevents system hang", "created_at": "", "docname": "11_requirements/system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_SYS_REL_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 97, "links": [], "links_back": ["SPEC_ARCH_LOGGING_1", "SPEC_ARCH_ERROR_RECOVERY_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["reliability", "error-handling"], "template": null, "title": "Error Handling and Recovery", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_SIM_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL support build-time selectable emulator mode (QEMU) that replaces hardware-specific modules with simulator implementations while preserving public APIs.\n\n**Rationale:**\nEnables development and testing without physical hardware, improves reproducibility and CI test coverage.\n\n**Acceptance Criteria:**\n\n* AC-1: Kconfig option ``CONFIG_TARGET_EMULATOR`` enables emulator builds\n* AC-2: Simulator implementations selected by CMake without requiring code changes\n* AC-3: Simulator components implement complete public API of hardware counterparts\n* AC-4: Emulator build runnable under QEMU with console output\n* AC-5: Documentation provides build/run verification steps", "created_at": "", "docname": "11_requirements/system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_SYS_SIM_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 135, "links": [], "links_back": ["REQ_NETIF_TUNNEL_1", "REQ_NETIF_TUNNEL_DOC_1", "SPEC_ARCH_NETIF_1", "SPEC_ARCH_QEMU_1", "SPEC_ARCH_QEMU_BUILD_1", "SPEC_ARCH_CODESPACES_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["emulator", "qemu", "testing"], "template": null, "title": "Emulator Support", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_SYS_WEB_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:**\nThe system SHALL provide web interface for configuration and monitoring.\n\n**Rationale:**\nUser-friendly interface for system setup and operation without firmware recompilation.\n\n**Acceptance Criteria:**\n\n* AC-1: Web interface accessible via HTTP\n* AC-2: Configuration changes applied without firmware recompilation\n* AC-3: Real-time monitoring of system status", "created_at": "", "docname": "11_requirements/system", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_SYS_WEB_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 42, "links": ["REQ_SYS_NET_1"], "links_back": ["REQ_WEB_1", "REQ_WEB_2", "REQ_WEB_4", "REQ_WEB_5", "SPEC_ARCH_WEB_1", "SPEC_ARCH_CERT_1", "SPEC_ARCH_WIFI_1", "SPEC_ARCH_HTTP_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "System Requirements", "sections": ["System Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "configuration"], "template": null, "title": "Web-based Configuration", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide a web page that displays current system status with real-time updates for user monitoring.\n\n**Rationale:** Users need to monitor the device's operation remotely via web interface without requiring physical access.\n\n**Acceptance Criteria:**\n\n- AC-1: Main page SHALL display current system status\n- AC-2: Status values SHALL update with reasonable responsiveness\n- AC-3: Page SHALL indicate system state (normal, error, warning)\n- AC-4: Page SHALL be accessible via web browser on mobile and desktop devices", "created_at": "", "docname": "11_requirements/web-server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_WEB_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 15, "links": ["REQ_SYS_WEB_1"], "links_back": ["REQ_WEB_NF_1", "REQ_WEB_NF_2"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "monitoring"], "template": null, "title": "Real-time Status Display", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_2": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide a web page for configuring device parameters as defined in the configuration management requirements.\n\n**Rationale:** Users need to adjust device settings remotely without firmware recompilation or physical access.\n\n**Acceptance Criteria:**\n\n- AC-1: Settings page SHALL display all user-configurable parameters\n- AC-2: Settings page SHALL validate user input ranges before submission\n- AC-3: Settings page SHALL provide immediate feedback on invalid inputs\n- AC-4: Settings page SHALL confirm successful parameter updates\n- AC-5: Settings page SHALL handle configuration save errors gracefully", "created_at": "", "docname": "11_requirements/web-server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_WEB_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 34, "links": ["REQ_SYS_WEB_1", "REQ_CFG_3"], "links_back": ["REQ_CFG_7", "REQ_WEB_NF_1", "REQ_WEB_NF_2", "SPEC_CFG_UI_1"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "configuration"], "template": null, "title": "Configuration Interface", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_3": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide a captive portal WiFi setup page for initial network configuration.\n\n**Rationale:** Users need an intuitive method to configure WiFi credentials without serial console access or hardcoded credentials.\n\n**Acceptance Criteria:**\n\n- AC-1: Device SHALL start in AP mode when WiFi credentials are not configured\n- AC-2: WiFi setup page SHALL display available WiFi networks (SSID scan)\n- AC-3: WiFi setup page SHALL accept SSID and password input\n- AC-4: WiFi setup page SHALL validate credentials by attempting connection\n- AC-5: WiFi setup page SHALL provide feedback on connection success/failure\n- AC-6: Device SHALL switch to STA mode after successful WiFi configuration", "created_at": "", "docname": "11_requirements/web-server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_WEB_3", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 54, "links": ["REQ_SYS_NET_1"], "links_back": ["REQ_WEB_NF_2"], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "wifi", "network"], "template": null, "title": "WiFi Setup Interface", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_4": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system SHALL provide navigation between multiple web pages (status, settings, WiFi setup).\n\n**Rationale:** Users need to access different functionality areas without memorizing URLs.\n\n**Acceptance Criteria:**\n\n- AC-1: All pages SHALL include navigation menu or links\n- AC-2: Navigation SHALL clearly indicate current page\n- AC-3: Navigation SHALL be accessible on mobile devices\n- AC-4: Page URLs SHALL be intuitive and RESTful (e.g., `/`, `/settings`, `/wifi`)", "created_at": "", "docname": "11_requirements/web-server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_WEB_4", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 75, "links": ["REQ_SYS_WEB_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "navigation"], "template": null, "title": "Web Interface Navigation", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_5": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The web server SHALL handle multiple simultaneous HTTP connections without blocking.\n\n**Rationale:** Multiple users or browser tabs may access the device simultaneously.\n\n**Acceptance Criteria:**\n\n- AC-1: Web server SHALL support at least 4 concurrent connections\n- AC-2: Server SHALL respond to new connections within 2 seconds under load\n- AC-3: Server SHALL not crash or hang under concurrent access\n- AC-4: Connection handling SHALL not interfere with real-time system operation", "created_at": "", "docname": "11_requirements/web-server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_WEB_5", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 94, "links": ["REQ_SYS_WEB_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "mandatory", "query": "", "rationale": "", "section_name": "Functional Requirements", "sections": ["Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "performance"], "template": null, "title": "HTTP Server Concurrency", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_NF_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Web pages SHOULD load and render within 3 seconds on typical mobile/desktop browsers.\n\n**Rationale:** Responsive UI improves user experience and reduces perceived latency.\n\n**Acceptance Criteria:**\n\n- AC-1: Initial page load SHALL complete within 3 seconds (excluding network latency)\n- AC-2: Navigation between pages SHALL feel instantaneous (<500ms)\n- AC-3: AJAX updates SHALL not cause page flickering or layout shifts", "created_at": "", "docname": "11_requirements/web-server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_WEB_NF_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 116, "links": ["REQ_WEB_1", "REQ_WEB_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "section_name": "Non-Functional Requirements", "sections": ["Non-Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "performance", "ux"], "template": null, "title": "Web UI Responsiveness", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "REQ_WEB_NF_2": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Web interface SHOULD be optimized for mobile devices with responsive design.\n\n**Rationale:** Many users will access the device from smartphones in the field.\n\n**Acceptance Criteria:**\n\n- AC-1: UI SHALL be usable on screens as small as 320px width\n- AC-2: Touch targets SHALL be at least 44x44px for mobile usability\n- AC-3: Text SHALL be readable without zooming on mobile devices", "created_at": "", "docname": "11_requirements/web-server", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "REQ_WEB_NF_2", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 134, "links": ["REQ_WEB_1", "REQ_WEB_2", "REQ_WEB_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "optional", "query": "", "rationale": "", "section_name": "Non-Functional Requirements", "sections": ["Non-Functional Requirements", "Web Server Requirements"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "mobile"], "template": null, "title": "Mobile-First Design", "type": "req", "type_name": "Requirement", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_BUILD_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Project uses ESP-IDF CMake build system with component registration.\n\n**Build Structure:**\n\n.. code-block:: cmake\n\n   # Top-level CMakeLists.txt\n   cmake_minimum_required(VERSION 3.16)\n   include($ENV{IDF_PATH}/tools/cmake/project.cmake)\n   project(esp32-template)\n\n   # Component CMakeLists.txt\n   idf_component_register(\n       SRCS \"component.c\"\n       INCLUDE_DIRS \".\"\n       REQUIRES esp_http_server nvs_flash\n   )\n\n**Configuration Files:**\n\n- ``sdkconfig``: ESP-IDF configuration (flash, partition table)\n- ``CMakeLists.txt``: Build definitions\n- ``main/Kconfig.projbuild``: Custom menuconfig options", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_BUILD_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 423, "links": ["REQ_SYS_HW_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Build System Integration", "sections": ["Build System Integration", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["build", "cmake"], "template": null, "title": "ESP-IDF CMake Integration", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_CERT_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Automated SSL certificate management for HTTPS (work in progress).\n\n**Purpose:** Enable HTTPS for web server without manual certificate management.\n\n**Key Design Decisions:**\n\n- **Build-Time Generation**: Certificates generated during build if missing\n- **Dual Tool Support**: OpenSSL binary (preferred) or Python cryptography fallback\n- **Firmware Embedding**: Uses ESP-IDF ``EMBED_FILES`` feature\n- **Long Validity**: 25-year certificate lifetime for device lifecycle\n\n**Location**: ``main/components/cert_handler/``\n\n**Status**: \ud83d\udea7 Implementation in progress, HTTPS not working in QEMU yet\n\n**Known Limitation**: HTTPS support in QEMU requires additional testing", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_CERT_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 113, "links": ["REQ_SYS_WEB_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Component Design Specifications", "sections": ["Component Design Specifications", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "draft", "style": null, "tags": ["component", "security"], "template": null, "title": "Certificate Handler Component Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_CODESPACES_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Template optimized for zero-setup development in GitHub Codespaces.\n\n**Development Environment:**\n\n- **DevContainer**: Ubuntu 24.04 with ESP-IDF v5.4.1 pre-installed\n- **QEMU**: Integrated emulator for hardware-free testing\n- **VS Code**: Pre-configured extensions (ESP-IDF, C/C++, Python)\n- **Pre-commit Hooks**: Quality gates for documentation\n\n**Workflow:**\n\n.. code-block:: text\n\n   Fork Template \u2192 Open in Codespaces \u2192 Customize main.c \u2192\n   Build \u2192 Test in QEMU \u2192 Flash to Hardware\n\n**Benefits**: Consistent environment, no local setup, works in browser", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_CODESPACES_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 484, "links": ["REQ_SYS_SIM_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Development Workflow Design", "sections": ["Development Workflow Design", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["development", "devcontainer"], "template": null, "title": "GitHub Codespaces Integration", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_COMM_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Components communicate through well-defined APIs and FreeRTOS primitives.\n\n**Communication Patterns:**\n\n.. code-block:: text\n\n   User Application\n        \u2195 (Function calls)\n   Component APIs\n        \u2195 (FreeRTOS primitives)\n   ESP-IDF HAL\n        \u2195 (Hardware registers)\n   Hardware\n\n**Synchronization Mechanisms:**\n\n- **Mutexes**: Protect shared configuration state\n- **Queues**: Producer-consumer data flow between tasks\n- **Event Groups**: Task coordination and signaling\n- **Semaphores**: Resource counting and blocking\n\n**Design Principle**: Components expose clean APIs; internal synchronization is hidden from users", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_COMM_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 171, "links": ["REQ_SYS_ARCH_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Data Flow Architecture", "sections": ["Data Flow Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["dataflow", "communication"], "template": null, "title": "Component Communication Pattern", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_CONFIG_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Example component demonstrating NVS-based configuration patterns.\n\n**Purpose:** Provide reference implementation for persistent configuration management.\n\n**Key Design Decisions:**\n\n- **NVS Storage**: Uses ESP-IDF Non-Volatile Storage API\n- **Runtime Cache**: Configuration cached in RAM for fast access\n- **Validation Framework**: All parameters validated before persistence\n- **Factory Reset**: Recovery mechanism included\n\n**Location**: ``main/components/config_manager/``\n\n**API Pattern**: Getter/setter functions with validation\n\n**See Also**: :doc:`config-manager` for detailed design", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_CONFIG_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 62, "links": ["REQ_SYS_CFG_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Component Design Specifications", "sections": ["Component Design Specifications", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["component", "config"], "template": null, "title": "Configuration Manager Component Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_CONFIG_FLOW_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Configuration flows through the system with caching and validation.\n\n**Flow Stages:**\n\n.. code-block:: text\n\n   Boot:      NVS \u2192 config_load() \u2192 Runtime Cache \u2192 Application\n   Runtime:   Application \u2192 config_get() \u2192 Runtime Cache (fast)\n   Update:    Web UI \u2192 Validation \u2192 config_save() \u2192 NVS \u2192 Cache\n   Factory:   Factory Reset \u2192 Defaults \u2192 NVS \u2192 Cache\n\n**Performance Optimization**: Runtime cache enables sub-microsecond config access\n\n**Data Integrity**: All updates validated before NVS write", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_CONFIG_FLOW_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 201, "links": ["REQ_SYS_CFG_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Data Flow Architecture", "sections": ["Data Flow Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["dataflow", "config"], "template": null, "title": "Configuration Data Flow", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_ERROR_RECOVERY_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Reset-first error recovery strategy for IoT device reliability.\n\n**Recovery Philosophy:**\n\nSystem uses **reset as primary recovery mechanism** for system-level failures, leveraging fast boot time (~3 seconds) and NVS persistence.\n\n**Error Classification:**\n\n1. **Protocol-Level Errors** \u2192 Handle gracefully\n\n   - TCP packet loss: Let lwIP retry\n   - HTTP timeouts: Return error to client\n   - Transient WiFi drops: Reconnection logic handles\n   - Configuration validation failures: Reject and log\n\n2. **System-Level Errors** \u2192 Reset device\n\n   - WiFi total failure after retries\n   - NVS corruption detection\n   - Critical component initialization failure\n   - Unrecoverable state machine deadlock\n\n**Watchdog Protection:**\n\n- Task watchdog enabled (CONFIG_ESP_TASK_WDT)\n- Prevents infinite loops and deadlocks\n- Automatic reset on watchdog timeout\n\n**Design Rationale:**\n\n- \u2705 Simpler code with fewer state machines\n- \u2705 Fast boot time makes reset acceptable\n- \u2705 NVS survives reset (configuration preserved)\n- \u2705 Reduced attack surface (less recovery code = fewer bugs)\n- \u2705 Deterministic recovery path\n\n**Trade-offs:**\n\n- May lose transient runtime state (acceptable for stateless IoT device)\n- Debugging requires log analysis (logging captures failure context)", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_ERROR_RECOVERY_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 562, "links": ["REQ_SYS_REL_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Error Recovery Strategy", "sections": ["Error Recovery Strategy", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["error-handling", "reliability", "reset"], "template": null, "title": "Error Recovery and Reset Strategy", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_FLASH_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Template configured for 4MB flash with optimized partitions.\n\n**Flash Layout:**\n\n- **Flash Size**: 4MB (suitable for most ESP32 modules)\n- **Partition Table**: Single App Large (maximizes app space)\n- **Free Space**: ~41% available for growth\n- **HTTPS Ready**: Sufficient space for SSL certificates\n\n**Partition Layout:**\n\n.. code-block:: text\n\n   Name        Type  Offset   Size\n   nvs         data  0x9000   24K   (config storage)\n   phy_init    data  0xf000   4K    (RF calibration)\n   factory     app   0x10000  ~3.8MB (firmware)\n\n**Verification**: ``idf.py size`` shows memory usage", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_FLASH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 454, "links": ["REQ_SYS_HW_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Build System Integration", "sections": ["Build System Integration", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["flash", "memory"], "template": null, "title": "Flash Memory Configuration", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_HTTP_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** HTTP server provides web interface and REST API.\n\n**Server Features:**\n\n- Static file serving from embedded filesystem\n- RESTful API endpoints for configuration\n- Captive portal detection and redirect\n- CORS headers for development\n\n**URL Structure:**\n\n.. code-block:: text\n\n   /                   \u2192 index.html (main page)\n   /settings           \u2192 settings.html (configuration)\n   /wifi-setup         \u2192 wifi-setup.html (captive portal)\n   /api/config         \u2192 REST API (GET/POST)\n   /api/wifi           \u2192 WiFi management API\n\n**Status**: \u2705 HTTP working, \ud83d\udea7 HTTPS in progress", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_HTTP_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 267, "links": ["REQ_SYS_WEB_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Data Flow Architecture", "sections": ["Data Flow Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["network", "http", "web"], "template": null, "title": "HTTP Server Architecture Details", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_LAYERS_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The system implements a four-layer architecture for clear separation of concerns.\n\n**Architecture Layers:**\n\n.. code-block:: text\n\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502                   User Application Layer                    \u2502\n   \u2502              (main.c - User customizable)                   \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2195\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502              Example Component Library                      \u2502\n   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n   \u2502 config_manager\u2502  web_server  \u2502 cert_handler \u2502 netif_tunnel  \u2502\n   \u2502  - NVS mgmt   \u2502  - HTTP API  \u2502  - SSL certs \u2502  - QEMU net   \u2502\n   \u2502  - Validation \u2502  - WiFi mgr  \u2502  - Auto-gen  \u2502  - UART tun   \u2502\n   \u2502  - Runtime    \u2502  - Captive   \u2502  - Embedding \u2502  - Bridge     \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2195\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502          ESP-IDF Hardware Abstraction Layer                 \u2502\n   \u2502   NVS | HTTP | WiFi | GPIO | FreeRTOS | Netif | TCP/IP     \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2195\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502            ESP32 Hardware / QEMU Emulator                   \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n**Layer Responsibilities:**\n\n1. **User Application Layer**: Entry point (``main.c``), application-specific logic\n2. **Component Library**: Reusable example components (config, web, networking)\n3. **ESP-IDF HAL**: Framework-provided hardware abstraction\n4. **Hardware**: Physical ESP32 or QEMU emulation\n\n**Design Rationale:** Layered architecture enables:\n\n- Independent testing of each layer\n- Component reuse across projects\n- Clear upgrade paths when ESP-IDF updates\n- Hardware/emulator abstraction", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_LAYERS_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 9, "links": ["REQ_SYS_ARCH_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Overview", "sections": ["Overview", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["architecture", "layering"], "template": null, "title": "ESP32 Template Layered Architecture", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_LOGGING_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Consistent logging strategy using ESP-IDF logging framework for diagnostics and debugging.\n\n**Log Levels:**\n\n- **ESP_LOGI**: Normal operational events (initialization, state transitions)\n- **ESP_LOGW**: Recoverable issues (degraded mode, fallback actions)\n- **ESP_LOGE**: Error conditions requiring attention (failed operations)\n- **ESP_LOGD**: Debug information (disabled in production builds)\n\n**Logging Guidelines:**\n\n- **Component TAGs**: Each file defines ``static const char* TAG`` with component name\n- **Error Context**: Always include ``esp_err_to_name()`` for ESP-IDF error codes\n- **Initialization**: Log start and completion of major initialization steps\n- **State Changes**: Log WiFi mode changes, connection events, system transitions\n- **User Actions**: Log web API requests and configuration changes\n\n**Build Configuration:**\n\n- **Production**: INFO level (boot sequence, errors, warnings)\n- **Development**: DEBUG level (detailed operational data)\n- **Configure via menuconfig**: Component config \u2192 Log output \u2192 Default log verbosity\n\n**Performance Consideration:**\n\nLogging is synchronous and blocks the calling task. Avoid logging in time-critical paths (ISRs, high-frequency tasks).\n\n**Example Usage:**\n\n.. code-block:: c\n\n   static const char* TAG = \"wifi_manager\";\n\n   ESP_LOGI(TAG, \"Initializing WiFi manager\");\n   esp_err_t ret = esp_wifi_init(&cfg);\n   if (ret != ESP_OK) {\n       ESP_LOGE(TAG, \"WiFi init failed: %s\", esp_err_to_name(ret));\n       return ret;\n   }", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_LOGGING_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 512, "links": ["REQ_SYS_REL_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Logging and Diagnostics", "sections": ["Logging and Diagnostics", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["logging", "diagnostics", "debugging"], "template": null, "title": "Logging and Diagnostics Strategy", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_MEMORY_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Memory managed with FreeRTOS heap and ESP-IDF capabilities.\n\n**Allocation Strategy:**\n\n- **Static**: Component structures at compile time (predictable)\n- **Dynamic**: Runtime allocations use ``heap_caps_malloc()``\n- **DMA Buffers**: Use ``MALLOC_CAP_DMA`` capability\n- **IRAM**: Use ``IRAM_ATTR`` only for time-critical ISRs\n\n**Memory Configuration:**\n\n- 4MB flash (CONFIG_ESPTOOLPY_FLASHSIZE_4MB)\n- ~41% free flash after base system\n- Monitor: ``esp_get_free_heap_size()``\n\n**Design Principle**: Prefer static allocation for predictable memory usage", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_MEMORY_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 396, "links": ["REQ_SYS_HW_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Threading Architecture", "sections": ["Threading Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["memory", "performance"], "template": null, "title": "Memory Management Strategy", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_NETIF_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** QEMU-specific network bridge enabling full TCP/IP stack in emulation.\n\n**Purpose:** Enable hardware-free development with real network connectivity.\n\n**Key Design Decisions:**\n\n- **UART-Based Tunnel**: Uses UART1 for frame transport\n- **Ethernet Encapsulation**: IP packets wrapped in Ethernet frames\n- **Length-Prefix Protocol**: 2-byte big-endian length header per frame\n- **Python Bridge**: Host-side TUN device management\n- **Conditional Compilation**: Only built for QEMU target\n\n**Architecture:**\n\n.. code-block:: text\n\n   ESP32 lwIP Stack \u2192 UART1 \u2192 Python Bridge \u2192 Host TUN Device\n\n**Location**: ``main/components/netif_uart_tunnel/``\n\n**Performance**: ~10 KB/s throughput (limited by 115200 baud UART)\n\n**See Also**: :doc:`../90_guides/qemu-network-internals` for implementation details", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_NETIF_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 137, "links": ["REQ_SYS_SIM_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Component Design Specifications", "sections": ["Component Design Specifications", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["component", "qemu", "network"], "template": null, "title": "Network Tunnel Component Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_PERF_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Template targets reasonable performance for IoT applications.\n\n**Performance Targets:**\n\n- **Boot Time**: < 3 seconds to WiFi connection\n- **Web Response**: < 500ms for configuration API calls\n- **Memory Usage**: < 100KB application heap usage\n- **Task Latency**: < 100ms for application tasks\n\n**Monitoring:**\n\n- Use ESP_LOGI() for timing measurements\n- Monitor heap with esp_get_free_heap_size()\n- Check stack usage with uxTaskGetStackHighWaterMark()\n- Profile with ESP-IDF performance tools", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_PERF_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 613, "links": ["REQ_SYS_PERF_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Performance Targets", "sections": ["Performance Targets", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["performance", "requirements"], "template": null, "title": "System Performance Requirements", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_QEMU_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Template supports QEMU emulation for hardware-free development.\n\n**Emulation Strategy:**\n\n- **Network Stack**: Full TCP/IP via UART tunnel (not WiFi simulation)\n- **Component Abstraction**: Optional simulator implementations with identical APIs\n- **Build System**: CMake automatically selects hardware vs. simulator components\n- **Clean Code**: No ``#ifdef`` conditionals in application code\n\n**Network Architecture:**\n\n.. code-block:: text\n\n   Browser (Host) \u2192 HTTP Proxy \u2192 TUN Bridge \u2192 QEMU UART1 \u2192 ESP32 lwIP\n\n**Components:**\n\n1. **QEMU Emulator**: ESP32 hardware emulation\n2. **Network Tunnel**: ``netif_uart_tunnel_sim.c`` driver\n3. **TUN Bridge**: ``tools/serial_tun_bridge.py`` (Python)\n4. **HTTP Proxy**: ``tools/http_proxy.py`` for browser access\n\n**Benefits**:\n\n- Fast iteration without hardware flashing\n- CI/CD automation without physical devices\n- GDB debugging with VS Code integration\n- Cross-platform development", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_QEMU_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 298, "links": ["REQ_SYS_SIM_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "QEMU Emulation Architecture", "sections": ["QEMU Emulation Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["qemu", "emulation"], "template": null, "title": "QEMU Hardware Abstraction", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_QEMU_BUILD_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Build system automatically selects appropriate component implementations.\n\n**Selection Mechanism:**\n\n.. code-block:: cmake\n\n   # Component CMakeLists.txt pattern\n   if(CONFIG_TARGET_EMULATOR)\n       set(COMPONENT_SRCS \"component_sim.c\")\n   else()\n       set(COMPONENT_SRCS \"component.c\")\n   endif()\n\n**Configuration**: ``idf.py menuconfig`` \u2192 \"Build for QEMU emulator\"\n\n**Design Benefits:**\n\n- Same header files for both implementations\n- No code pollution with conditional compilation\n- Easy to add simulator support to any component", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_QEMU_BUILD_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 334, "links": ["REQ_SYS_SIM_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "QEMU Emulation Architecture", "sections": ["QEMU Emulation Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["qemu", "build"], "template": null, "title": "QEMU Component Selection", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_TASKS_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Application uses FreeRTOS tasks with priority-based scheduling.\n\n**Task Structure:**\n\n.. code-block:: text\n\n   Core 0: Application Tasks (user-defined)\n   \u251c\u2500\u2500 Main Task (Priority 1)\n   \u2502   \u2514\u2500\u2500 Initialization and coordination\n   \u2514\u2500\u2500 User Tasks (Priority varies)\n       \u2514\u2500\u2500 Application-specific logic\n\n   Core 1: WiFi/Network Stack (ESP-IDF managed)\n   \u251c\u2500\u2500 WiFi Management (Priority 2+)\n   \u251c\u2500\u2500 TCP/IP Stack (lwIP)\n   \u2514\u2500\u2500 HTTP Server\n\n**Design Guidelines:**\n\n- Core 0 for application tasks\n- Core 1 reserved for WiFi/network (best performance)\n- Priority range: 0-25 (higher = more important)\n- Monitor stack with ``uxTaskGetStackHighWaterMark()``", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_TASKS_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 365, "links": ["REQ_SYS_ARCH_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Threading Architecture", "sections": ["Threading Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["threading", "rtos"], "template": null, "title": "FreeRTOS Task Organization", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_WEB_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Example HTTP server with WiFi management and captive portal.\n\n**Purpose:** Provide reference implementation for web-based device configuration.\n\n**Key Design Decisions:**\n\n- **HTTP Server**: ESP-IDF ``esp_http_server`` component\n- **Static Files**: Embedded in firmware using ``EMBED_FILES``\n- **Captive Portal**: DNS server redirects all requests to device\n- **WiFi Manager**: Automatic AP/STA mode switching with NVS credentials\n- **Fallback Logic**: AP mode if STA connection fails\n\n**Location**: ``main/components/web_server/``\n\n**API Pattern**: Initialization function, REST endpoints for configuration\n\n**Status**: \u2705 HTTP working, \ud83d\udea7 HTTPS in progress\n\n**See Also**: Web server requirements in :doc:`../11_requirements/web-server`", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_WEB_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 86, "links": ["REQ_SYS_WEB_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Component Design Specifications", "sections": ["Component Design Specifications", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["component", "web", "network"], "template": null, "title": "Web Server Component Design", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_ARCH_WIFI_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** WiFi management with automatic reconnection and AP fallback, including recovery strategy after network loss.\n\n**WiFi Operation Modes:**\n\n1. **Station (STA) Mode**: Connect to existing WiFi network\n2. **Access Point (AP) Mode**: Create configuration network\n3. **Fallback Logic**: Auto-switch to AP if STA fails\n\n**Connection Flow:**\n\n.. code-block:: text\n\n   Boot \u2192 Load NVS Credentials \u2192 STA Connection Attempt\n                                        \u2193 (success)\n                                   STA Connected\n                                        \u2193 (failure after timeout)\n                                   AP Mode + Captive Portal\n                                   (retries STA every 5 min)\n                                        \u2193 (5 min timeout reached)\n                                       Reset & Boot\n\n**AP Mode Failsafe Recovery:**\n\n- **Purpose**: Handle scenarios where network is unavailable after power loss\n- **AP Entry**: System enters AP mode with captive portal when STA connection fails\n- **Retry Strategy**: Attempts to reconnect to configured network every 5 minutes\n- **Recovery Timeout**: After 5 minutes in AP mode without successful STA connection, system performs reset\n- **Rationale**: Prevents indefinite AP mode if network hardware has failed or credentials are invalid; ensures system attempts network recovery periodically\n\n**Credential Management:**\n\n- WiFi SSID/password stored in NVS\n- Factory reset clears credentials\n- Web interface provides credential update\n\n**Status**: \u2705 Complete with NVS integration", "created_at": "", "docname": "12_design/high-level-architecture", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_ARCH_WIFI_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 223, "links": ["REQ_SYS_WEB_1"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Data Flow Architecture", "sections": ["Data Flow Architecture", "High-Level Architecture Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["network", "wifi"], "template": null, "title": "WiFi Manager Design Details", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_API_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Minimal, type-safe API for configuration management supporting uint16 and string types only.\n\n**Core API Functions:**\n\n.. code-block:: c\n\n   // Lifecycle management\n   esp_err_t config_init(void);\n   esp_err_t config_load_from_nvs(system_config_t* config);\n   esp_err_t config_save_to_nvs(const system_config_t* config);\n   esp_err_t config_factory_reset(void);\n\n   // Type-safe parameter setters (validation at write-time)\n   esp_err_t config_set_uint16(config_param_id_t param, uint16_t value);\n   esp_err_t config_set_string(config_param_id_t param, const char* value);\n\n   // Type-safe parameter getters (read from runtime config)\n   esp_err_t config_get_uint16(config_param_id_t param, uint16_t* value);\n   esp_err_t config_get_string(config_param_id_t param, char* value, size_t max_len);\n\n   // Bulk validation (before NVS persistence)\n   esp_err_t config_validate(const system_config_t* config,\n                             char* error_msg, size_t msg_len);\n\n**Typical Usage Pattern:**\n\n.. code-block:: c\n\n   // Application updates parameters with immediate validation\n   if (config_set_string(CONFIG_WIFI_SSID, user_input) != ESP_OK) {\n       ESP_LOGE(TAG, \"SSID invalid\");\n       return;\n   }\n\n   if (config_set_string(CONFIG_WIFI_PASSWORD, password_input) != ESP_OK) {\n       ESP_LOGE(TAG, \"Password invalid\");\n       return;\n   }\n\n   // Validate complete configuration before saving\n   char error_msg[128];\n   if (config_validate(&runtime_config, error_msg, sizeof(error_msg)) != ESP_OK) {\n       ESP_LOGE(TAG, \"Configuration invalid: %s\", error_msg);\n       return;\n   }\n\n   // Save to NVS (system reset follows)\n   config_save_to_nvs(&runtime_config);\n\n**Thread Safety:** All functions protected by FreeRTOS mutex with configurable timeout.\n\n**Important Note:** Parameter changes do not take effect until system restarts. Dynamic parameter application is not guaranteed. This is by design: validation at setter time prevents invalid states from propagating into NVS.\n\n**Design Rationale:**\n\n- **Type Safety**: Enum + typed setters prevent type confusion and buffer overflows\n- **Validation at Gate**: String parameters length-checked immediately before storage\n- **Simple & Predictable**: Two type-safe functions instead of per-parameter getter/setter explosion\n- **Pragmatic for Embedded C**: Minimal abstraction, direct structure access with safety guardrails\n- **Easy to Extend**: Add new parameters to enum and update validation rules only", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_API_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 227, "links": ["REQ_CFG_5", "REQ_CFG_6"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "API Design", "sections": ["API Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["api", "interface"], "template": null, "title": "Configuration API Interface", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_ARCH_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** The configuration system implements a three-layer architecture for separation of concerns.\n\n**Architecture Layers:**\n\n.. code-block:: text\n\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502           Application Layer             \u2502\n   \u2502  (main.c, components, web_server.c)     \u2502\n   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n   \u2502         Configuration API Layer         \u2502\n   \u2502    (config.h, config.c - Public API)    \u2502\n   \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n   \u2502           Storage Layer                 \u2502\n   \u2502     (NVS abstraction, validation)       \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n**Layer Responsibilities:**\n\n- **Application Layer**: Consumes configuration values through standardized API\n- **Configuration API Layer**: Provides thread-safe access, validation, and caching\n- **Storage Layer**: Handles NVS operations, persistence, and error recovery\n\n**Design Rationale:** Layered architecture enables independent testing, simplifies maintenance, and provides clear separation between business logic and storage concerns.", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_ARCH_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 9, "links": ["REQ_CFG_1", "REQ_CFG_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Architecture Design", "sections": ["Architecture Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["architecture", "config"], "template": null, "title": "Layered Configuration Architecture", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_ERROR_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Configuration system handles NVS failures gracefully with automatic recovery.\n\n**Error Recovery Strategy:**\n\n1. **Corruption Detection**: CRC32 mismatch triggers recovery\n2. **Magic Number Check**: Invalid magic triggers factory reset\n3. **Version Migration**: Unsupported version triggers controlled migration or reset\n4. **Fallback to Defaults**: Any read failure results in default configuration\n5. **Logging**: All errors logged with ESP_LOGE for debugging\n\n**Boot Behavior:** System always boots successfully even with corrupted NVS.\n\n**User Notification:** Web interface displays warning banner if defaults used.", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_ERROR_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 517, "links": ["REQ_CFG_10"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Error Handling Design", "sections": ["Error Handling Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["error-handling", "nvs"], "template": null, "title": "NVS Error Recovery Strategy", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_FLOW_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Configuration data flows through the system with caching and validation.\n\n**Data Flow Stages:**\n\n.. code-block:: text\n\n   Startup:  NVS \u2192 config_load() \u2192 Runtime Cache \u2192 Application\n   Runtime:  Application \u2192 config_get() \u2192 Runtime Cache\n   Update:   Web Interface \u2192 config_save() \u2192 Validation \u2192 NVS \u2192 Runtime Cache\n   Factory:  config_factory_reset() \u2192 Defaults \u2192 NVS \u2192 Runtime Cache\n\n**Key Design Decisions:**\n\n1. **Runtime Cache**: Configuration cached in RAM for fast access (<10 CPU cycles)\n2. **Atomic Updates**: Configuration changes applied atomically to prevent partial updates\n3. **Validation Gate**: All changes validated before persistence to prevent invalid state\n4. **Error Recovery**: Automatic fallback to defaults on NVS corruption", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_FLOW_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 41, "links": ["REQ_CFG_3", "REQ_CFG_4", "REQ_CFG_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Architecture Design", "sections": ["Architecture Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["architecture", "dataflow"], "template": null, "title": "Configuration Data Flow", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_LOGGING_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** All configuration changes logged for debugging and audit trail.\n\n**Logging Format:**\n\n.. code-block:: text\n\n   [CONFIG] Parameter changed: wifi password -> ****** (user: web)\n   [CONFIG] Configuration saved to NVS (save_count: 42)\n   [CONFIG] Factory reset performed (reason: user request)\n\n**Log Levels:**\n\n- ESP_LOGI: Normal configuration changes\n- ESP_LOGW: Validation failures, preview timeouts\n- ESP_LOGE: NVS errors, corruption detected\n- ESP_LOGD: Detailed debug info (disabled in production)\n\n**Performance:** Logging does not block configuration operations.", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_LOGGING_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 538, "links": ["REQ_CFG_11"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Error Handling Design", "sections": ["Error Handling Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["logging", "debugging"], "template": null, "title": "Configuration Logging", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_PARAM_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Configuration parameters identified by enum for type-safe access.\n\n**Parameter Enumeration:**\n\n.. code-block:: c\n\n   typedef enum {\n       // WiFi Credentials\n       CONFIG_WIFI_SSID,\n       CONFIG_WIFI_PASSWORD,\n\n       // Extension point for application parameters\n       // CONFIG_APP_PARAM_1,\n       // CONFIG_APP_PARAM_2,\n\n       CONFIG_PARAM_COUNT  // Sentinel for bounds checking\n   } config_param_id_t;\n\n**Design Rationale:** Enum-based parameter identification enables compile-time type checking and prevents parameter ID collisions when extending configuration.", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_PARAM_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 200, "links": ["REQ_CFG_5"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "API Design", "sections": ["API Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["api", "parameter"], "template": null, "title": "Configuration Parameter Identifiers", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_PREVIEW_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Configuration changes validated immediately but only persisted after system reset.\n\n**Parameter Update Lifecycle:**\n\n.. code-block:: text\n\n   1. User updates parameter via web UI\n      \u2193\n   2. POST /api/config/param with {param, type, value}\n      \u2193\n   3. config_set_string/uint16() \u2192 Setter validates THIS parameter\n      \u2193\n   4. If invalid \u2192 error response with details \u2192 STOP\n   5. If valid \u2192 stored in runtime config (RAM)\n      \u2193\n   6. config_validate() \u2192 validate entire config for consistency\n      \u2193\n   7. If invalid \u2192 error response with details \u2192 rollback runtime state \u2192 STOP\n   8. If valid \u2192 response OK \"Changes staged, ready to apply\"\n      \u2193\n   9. User can update more parameters (go to step 1) or click \"Apply & Save\"\n      \u2193\n  10. POST /api/config/apply\n      \u2193\n  11. config_save_to_nvs() persists to NVS\n      \u2193\n  12. System reset (to apply changes consistently)\n\n**Key Design Decisions:**\n\n1. **Immediate Post-Save Validation**: Every parameter change validated against entire config immediately (step 6-8). User gets feedback about which parameter caused issues, preventing confusion about what went wrong.\n\n2. **Staged Changes Before Apply**: Parameters can be updated multiple times (steps 1-9). Each update validates individually and against full config. User sees all issues immediately.\n\n3. **Separate Apply Step**: Actual NVS persistence happens only on explicit \"Apply & Save\" (steps 10-12). Allows user to review all staged changes before committing.\n\n4. **Reset After Save**: Ensures all components see new configuration on boot and prevents inconsistent state.\n\n**Design Rationale:**\n\n- **Validation Transparency**: User always knows if their changes are valid and why they failed\n- **Multiple Parameter Updates**: Common workflow (change WiFi SSID + password together)\n- **Safety**: Reset-after-save is pragmatic for embedded systems vs. complex hot-reloading\n- **Simple Implementation**: Two-phase approach (stage \u2192 apply) without dynamic reconfiguration", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_PREVIEW_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 428, "links": ["REQ_CFG_8"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Web Interface Design", "sections": ["Web Interface Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "lifecycle"], "template": null, "title": "Real-time Configuration Updates", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_RUNTIME_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Runtime configuration structure holds actively used parameters in RAM for fast access.\n\n**Current Implementation (Template Scope):**\n\nThe template currently uses configuration for **WiFi credentials only**:\n\n.. code-block:: c\n\n   typedef struct {\n       // WiFi Credentials (Required for network connectivity)\n       char wifi_ssid[33];           // WiFi network name (IEEE 802.11 max 32 chars)\n       char wifi_password[65];       // WiFi password (WPA max 64 chars)\n\n       // Metadata\n       uint32_t config_version;      // Schema version for compatibility\n       uint32_t save_count;          // Number of saves (statistics)\n\n   } system_config_t;\n\n**WiFi Module Configuration:**\n\nOther WiFi parameters (AP channel, max connections, STA retries, timeouts) are configured in the WiFi module header file (`main/components/web_server/wifi_manager.h`):\n\n.. code-block:: c\n\n   // In wifi_manager.h - compile-time defaults\n   #define WIFI_AP_CHANNEL           6\n   #define WIFI_AP_MAX_CONN          4\n   #define WIFI_STA_MAX_RETRY        5\n   #define WIFI_STA_TIMEOUT_MS       10000\n\n**Storage Philosophy:**\n\n- **NVS Storage** (Runtime configuration): Only user-configurable WiFi credentials (SSID, password)\n- **Compile-Time Headers**: All hardware defaults and WiFi parameters defined in component headers\n- **Rationale**: Minimizes NVS usage, keeps configuration truly minimal and focused\n\n**Application-Specific Parameters:**\n\nWhen forking the template for your project, define application parameters in your component headers, not in NVS:\n\n.. code-block:: c\n\n   // In my_component/include/my_component.h (NOT in system_config_t)\n   #define SENSOR_RANGE_MIN_MM        50\n   #define SENSOR_RANGE_MAX_MM        400\n   #define LED_COUNT                  30\n   #define LED_BRIGHTNESS_DEFAULT     200\n   #define MEASUREMENT_INTERVAL_MS    100\n\nIf you need runtime-configurable application parameters (rare), extend `system_config_t` **only for those specific parameters**, not for every possible setting.\n\n**Design Guidelines for Extensions:**\n\n1. **Keep WiFi settings in NVS** - Required for user configuration\n2. **Define hardware parameters in headers** - Reduces NVS bloat\n3. **Only add to NVS if truly dynamic** - User needs to change it after deployment\n4. **Use #define for constants** - Compile-time optimization\n5. **Increment config_version** - Only if you add runtime-configurable parameters to struct\n\n**Reset Requirement After Parameter Changes:**\n\n\u26a0\ufe0f **Important**: Configuration changes only take effect after system reset.\n\n- Changes written to runtime config are visible immediately (for API feedback)\n- Changes persisted to NVS via ``config_save_to_nvs()`` trigger automatic reset\n- Reset ensures all components see new configuration on boot\n- Dynamic reconfiguration is not supported (complexity not justified for IoT devices)\n\n**Design Rationale:** Reset-after-save prevents inconsistent state where some components use old config while others use new. Simpler than hot-reloading configuration.\n\n**Type Conversion Strategy:**\n\n- **NVS Storage**: Use fixed-width integers (uint8_t, uint16_t, uint32_t)\n- **Runtime Use**: Convert to application-friendly types as needed\n- **Example**: Store channel as uint8_t, validate as 1-13 in setter\n\n**Performance Characteristics:**\n\n- Setter Validation: <1ms (length check, range validation)\n- Full Validation: <5ms (all parameters checked)\n- NVS Write: <50ms, then reset within 2 seconds\n- Memory Overhead: Structure size < 128 bytes (typical)", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_RUNTIME_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 106, "links": ["REQ_CFG_3"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Data Structure Design", "sections": ["Data Structure Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["data-structure", "runtime"], "template": null, "title": "Runtime Configuration Structure", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_STORAGE_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Configuration stored in NVS as packed 64-byte structure with metadata and checksums.\n\n**Storage Layout:**\n\n.. code-block:: c\n\n   typedef struct {\n       // Metadata (16 bytes)\n       uint32_t magic_number;        // 0xCFG12345 - corruption detection\n       uint32_t config_version;      // Schema version for migration\n       uint32_t crc32_checksum;      // Data integrity verification\n       uint32_t save_count;          // Change tracking\n\n       // Component configurations (~48 bytes)\n       // ... component-specific fields ...\n\n       // Reserved for expansion\n       uint8_t reserved[N];          // Future-proofing\n\n   } __attribute__((packed)) config_nvs_storage_t;\n\n**Storage Optimization:**\n\n- Fixed Size: 64-byte structure for efficient NVS operations\n- Alignment: Packed structure to minimize flash usage\n- Reserved Fields: Expansion capability without breaking compatibility\n- Checksum: CRC32 for corruption detection and recovery\n\n**Migration Strategy:** Version field enables schema migration when structure changes.", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_STORAGE_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 69, "links": ["REQ_CFG_3", "REQ_CFG_4"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Data Structure Design", "sections": ["Data Structure Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["data-structure", "storage"], "template": null, "title": "NVS Storage Format", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_UI_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** HTML5 settings page with form validation and real-time updates.\n\n**Page Structure:**\n\n.. code-block:: text\n\n   <form id=\"config-form\">\n     <fieldset>\n       <legend>Component Settings</legend>\n       <input type=\"range\" id=\"param1\" min=\"X\" max=\"Y\" step=\"Z\">\n       <span class=\"value-display\">Current: <span id=\"param1-value\"></span></span>\n     </fieldset>\n\n     <div class=\"config-actions\">\n       <button type=\"button\" id=\"preview-btn\">Preview</button>\n       <button type=\"button\" id=\"apply-btn\">Apply &amp; Save</button>\n       <button type=\"button\" id=\"reset-btn\">Factory Reset</button>\n     </div>\n   </form>\n\n**JavaScript Behavior:**\n\n- Range inputs trigger live preview (debounced 500ms)\n- Value displays update in real-time\n- Factory reset requires confirmation dialog\n- Success/error messages displayed via toast notifications", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_UI_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 480, "links": ["REQ_CFG_7", "REQ_WEB_2"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Web Interface Design", "sections": ["Web Interface Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "ui", "html"], "template": null, "title": "Web Settings Page", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_VALIDATION_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** Parameters validated at two points: immediate setter validation and pre-save bulk validation.\n\n**Validation Strategy:**\n\n1. **Setter-Time Validation** (Immediate):\n\n   .. code-block:: c\n\n      config_set_string(CONFIG_WIFI_SSID, value)\n      // Validates: length 1-32 characters\n\n      config_set_string(CONFIG_WIFI_PASSWORD, value)\n      // Validates: length 0-63 characters (0 = open network)\n\n   Returns ESP_ERR_INVALID_ARG on validation failure, preventing invalid values in runtime config.\n\n2. **Pre-Save Bulk Validation** (Before NVS):\n\n   .. code-block:: c\n\n      config_validate(&config, error_msg, sizeof(error_msg))\n      // Validates entire config for semantic consistency\n      // Example: check WiFi AP max connections is within device capabilities\n\n**WiFi Parameter Constraints:**\n\n- ``CONFIG_WIFI_SSID``: 1-32 characters (IEEE 802.11 max)\n- ``CONFIG_WIFI_PASSWORD``: 0-63 characters (WPA2 max, 0 = open network)\n\n**Design Rationale:**\n\n- **Early Rejection**: Invalid strings rejected at setter, preventing buffer corruption\n- **Simple Rules**: Type constraints only (length for strings)\n- **WiFi Defaults**: Channel, max connections, retry, and timeout configured in `wifi_manager.h`\n- **Extension Pattern**: When adding application parameters, define min/max in parameter table\n\n**Error Handling:**\n\n- Setter validation: Return ``ESP_ERR_INVALID_ARG`` immediately\n- Pre-save validation: Return error message describing what's invalid\n- All errors logged with ``ESP_LOGE`` for debugging", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_VALIDATION_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 295, "links": ["REQ_CFG_6"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "API Design", "sections": ["API Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["validation", "api"], "template": null, "title": "Parameter Validation Rules", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}, "SPEC_CFG_WEB_API_1": {"acceptance_criteria": "", "arch": {}, "avatar": "", "closed_at": "", "completion": null, "constraints": [], "constraints_error": null, "constraints_passed": true, "constraints_results": {}, "content": "**Description:** RESTful HTTP API for configuration management via web interface.\n\n**API Endpoints:**\n\n.. code-block:: text\n\n   GET  /api/config              -> Current configuration (JSON)\n   POST /api/config/param        -> Set single parameter\n   POST /api/config/validate     -> Validate current config before save\n   POST /api/config/apply        -> Apply & save to NVS (triggers reset)\n   POST /api/config/reset        -> Factory reset\n\n**Set Parameter Request:**\n\n.. code-block:: http\n\n   POST /api/config/param\n   Content-Type: application/json\n\n   {\n     \"param\": \"CONFIG_WIFI_SSID\",\n     \"type\": \"string\",\n     \"value\": \"my-network\"\n   }\n\n**Response on Error:**\n\n.. code-block:: json\n\n   {\n     \"status\": \"error\",\n     \"code\": \"INVALID_ARG\",\n     \"message\": \"SSID too long (max 32 characters)\"\n   }\n\n**Get Current Configuration:**\n\n.. code-block:: http\n\n   GET /api/config\n\n   Response:\n   {\n     \"version\": \"1.0\",\n     \"timestamp\": \"2025-07-24T12:34:56Z\",\n     \"config\": {\n       \"wifi_ssid\": \"my-network\",\n       \"wifi_password\": \"***\"\n     }\n   }\n\n**Apply & Save:**\n\n.. code-block:: http\n\n   POST /api/config/apply\n\n   Response (before reset):\n   {\n     \"status\": \"ok\",\n     \"message\": \"Configuration saved, system resetting...\"\n   }\n\n   Then: System reset within 2 seconds\n\n**Design Rationale:**\n\n- **Generic Parameter Endpoint**: Single /api/config/param handles all parameter types\n- **Type Information**: Client specifies type (\"string\", \"uint16\") for clarity\n- **Pre-Save Validation**: /api/config/validate allows testing without reset\n- **Simple & Extensible**: Adding new parameters requires only enum update, no new endpoints\n\n**Authentication:** Currently open (for development). Production deployments should add basic auth or API tokens.", "created_at": "", "docname": "12_design/config-manager", "doctype": ".rst", "duration": null, "external_css": "external_link", "external_url": null, "has_dead_links": false, "has_forbidden_dead_links": false, "id": "SPEC_CFG_WEB_API_1", "id_prefix": "", "is_external": false, "is_import": false, "is_modified": false, "jinja_content": false, "layout": null, "lineno": 347, "links": ["REQ_CFG_7", "REQ_CFG_8", "REQ_CFG_9"], "links_back": [], "max_amount": "", "max_content_lines": "", "modifications": 0, "params": "", "parent_need": null, "parent_needs": [], "parent_needs_back": [], "parts": {}, "post_content": null, "post_template": null, "pre_content": null, "pre_template": null, "prefix": "", "priority": "", "query": "", "rationale": "", "section_name": "Web Interface Design", "sections": ["Web Interface Design", "Configuration Manager Design Specification"], "service": "", "signature": null, "specific": "", "status": "approved", "style": null, "tags": ["web", "api", "rest"], "template": null, "title": "Configuration REST API", "type": "spec", "type_name": "Design Specification", "updated_at": "", "url": "", "url_postfix": "", "user": ""}}, "needs_amount": 65, "needs_schema": {"$schema": "http://json-schema.org/draft-07/schema#", "properties": {"acceptance_criteria": {"default": "", "description": "Added by needs_extra_options config", "field_type": "extra", "type": "string"}, "arch": {"additionalProperties": {"type": "string"}, "default": {}, "description": "Mapping of uml key to uml content.", "field_type": "core", "type": "object"}, "avatar": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "closed_at": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "completion": {"default": null, "description": "Added for needgantt functionality", "field_type": "extra", "type": "integer"}, "constraints": {"default": [], "description": "List of constraint names, which are defined for this need.", "field_type": "core", "items": {"type": "string"}, "type": "array"}, "constraints_error": {"default": null, "description": "An error message set if any constraint failed, and `error_message` field is set in config.", "field_type": "core", "type": ["string", "null"]}, "constraints_passed": {"default": true, "description": "True if all constraints passed, False if any failed, None if not yet checked.", "field_type": "core", "type": ["boolean", "null"]}, "constraints_results": {"additionalProperties": {"type": "object"}, "default": {}, "description": "Mapping of constraint name, to check name, to result, None if not yet checked.", "field_type": "core", "type": ["object", "null"]}, "content": {"default": "", "description": "The main content of the need.", "field_type": "core", "type": "string"}, "created_at": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "docname": {"default": null, "description": "Name of the document where the need is defined (None if external).", "field_type": "core", "type": ["string", "null"]}, "doctype": {"default": ".rst", "description": "The markup type of the content, denoted by the suffix of the source file, e.g. '.rst'.", "field_type": "core", "type": "string"}, "duration": {"default": null, "description": "Added for needgantt functionality", "field_type": "extra", "type": "integer"}, "external_css": {"default": "", "description": "CSS class name, added to the external reference.", "field_type": "core", "type": "string"}, "external_url": {"default": null, "description": "URL of the need, if it is an external need.", "field_type": "core", "type": ["string", "null"]}, "has_dead_links": {"default": false, "description": "True if any links reference need ids that are not found in the need list.", "field_type": "core", "type": "boolean"}, "has_forbidden_dead_links": {"default": false, "description": "True if any links reference need ids that are not found in the need list, and the link type does not allow dead links.", "field_type": "core", "type": "boolean"}, "id": {"description": "ID of the data.", "field_type": "core", "type": "string"}, "id_prefix": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "is_external": {"default": false, "description": "If true, no node is created and need is referencing external url.", "field_type": "core", "type": "boolean"}, "is_import": {"default": false, "description": "If true, the need was derived from an import.", "field_type": "core", "type": "boolean"}, "is_modified": {"default": false, "description": "Whether the need was modified by needextend.", "field_type": "core", "type": "boolean"}, "jinja_content": {"default": false, "description": "Whether the content was pre-processed by jinja.", "field_type": "core", "type": "boolean"}, "layout": {"default": null, "description": "Key of the layout, which is used to render the need.", "field_type": "core", "type": ["string", "null"]}, "lineno": {"default": null, "description": "Line number where the need is defined (None if external).", "field_type": "core", "type": ["integer", "null"]}, "links": {"default": [], "description": "Link field", "field_type": "links", "items": {"type": "string"}, "type": "array"}, "links_back": {"default": [], "description": "Backlink field", "field_type": "backlinks", "items": {"type": "string"}, "type": "array"}, "max_amount": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "max_content_lines": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "modifications": {"default": 0, "description": "Number of modifications by needextend.", "field_type": "core", "type": "integer"}, "params": {"default": "", "description": "Added by service open-needs", "field_type": "extra", "type": "string"}, "parent_need": {"default": null, "description": "Simply the first parent id.", "field_type": "core", "type": ["string", "null"]}, "parent_needs": {"default": [], "description": "Link field", "field_type": "links", "items": {"type": "string"}, "type": "array"}, "parent_needs_back": {"default": [], "description": "Backlink field", "field_type": "backlinks", "items": {"type": "string"}, "type": "array"}, "parts": {"additionalProperties": {"type": "object"}, "default": {}, "description": "Mapping of parts, a.k.a. sub-needs, IDs to data that overrides the need's data", "field_type": "core", "type": "object"}, "post_content": {"default": null, "description": "Additional content after the need.", "field_type": "core", "type": ["string", "null"]}, "post_template": {"default": null, "description": "The template key, if the post_content was created from a jinja template.", "field_type": "core", "type": ["string", "null"]}, "pre_content": {"default": null, "description": "Additional content before the need.", "field_type": "core", "type": ["string", "null"]}, "pre_template": {"default": null, "description": "The template key, if the pre_content was created from a jinja template.", "field_type": "core", "type": ["string", "null"]}, "prefix": {"default": "", "description": "Added by service open-needs", "field_type": "extra", "type": "string"}, "priority": {"default": "", "description": "Added by needs_extra_options config", "field_type": "extra", "type": "string"}, "query": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "rationale": {"default": "", "description": "Added by needs_extra_options config", "field_type": "extra", "type": "string"}, "section_name": {"default": null, "description": "Simply the first section.", "field_type": "core", "type": ["string", "null"]}, "sections": {"default": [], "description": "Sections of the need.", "field_type": "core", "items": {"type": "string"}, "type": "array"}, "service": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "signature": {"default": null, "description": "Derived from a docutils desc_name node.", "field_type": "core", "type": ["string", "null"]}, "specific": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "status": {"default": null, "description": "Status of the need.", "field_type": "core", "type": ["string", "null"]}, "style": {"default": null, "description": "Comma-separated list of CSS classes (all appended by `needs_style_`).", "field_type": "core", "type": ["string", "null"]}, "tags": {"default": [], "description": "List of tags.", "field_type": "core", "items": {"type": "string"}, "type": "array"}, "template": {"default": null, "description": "The template key, if the content was created from a jinja template.", "field_type": "core", "type": ["string", "null"]}, "title": {"description": "Title of the need.", "field_type": "core", "type": "string"}, "type": {"default": "", "description": "Type of the need.", "field_type": "core", "type": "string"}, "type_name": {"default": "", "description": "Name of the type.", "field_type": "core", "type": "string"}, "updated_at": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "url": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}, "url_postfix": {"default": "", "description": "Added by service open-needs", "field_type": "extra", "type": "string"}, "user": {"default": "", "description": "Added by service github-issues", "field_type": "extra", "type": "string"}}, "type": "object"}}}}